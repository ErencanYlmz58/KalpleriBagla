<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalpleri Yakala - Sevgi Oyunu</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #ff9a9e, #fad0c4);
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            color: #333;
        }
        
        .container {
            width: 90%;
            max-width: 800px;
            background-color: rgba(255, 255, 255, 0.85);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            position: relative;
        }
        
        #start-screen {
            padding: 30px;
            text-align: center;
        }
        
        #game-screen {
            display: none;
            height: 500px;
            position: relative;
            overflow: hidden;
            background-color: #fff9fb;
        }
        
        #end-screen {
            display: none;
            padding: 30px;
            text-align: center;
        }
        
        h1 {
            color: #e83e8c;
            margin-bottom: 20px;
        }
        
        p {
            margin-bottom: 20px;
            line-height: 1.6;
        }
        
        button {
            background: linear-gradient(to right, #ff6b6b, #ff8e8e);
            border: none;
            color: white;
            padding: 12px 24px;
            font-size: 18px;
            border-radius: 50px;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            font-weight: bold;
            margin: 10px;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
        }
        
        .player {
            position: absolute;
            bottom: 20px;
            width: 70px;
            height: 70px;
            background-color: #fff;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            font-size: 30px;
            z-index: 10;
            transition: left 0.1s ease-out;
            user-select: none;
        }
        
        .falling-heart {
            position: absolute;
            font-size: 30px;
            user-select: none;
            animation: fall linear;
            z-index: 5;
        }
        
        .special-heart {
            position: absolute;
            font-size: 40px;
            user-select: none;
            animation: fall linear, pulse 1s infinite;
            z-index: 6;
        }
        
        .obstacle {
            position: absolute;
            background-color: rgba(0, 0, 0, 0.1);
            border-radius: 5px;
            animation: fall linear;
            z-index: 4;
        }
        
        .score-display {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 20px;
            font-weight: bold;
            color: #e83e8c;
        }
        
        .message-count {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 20px;
            font-weight: bold;
            color: #e83e8c;
        }
        
        .message-popup {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            z-index: 20;
            display: none;
            max-width: 80%;
            text-align: center;
        }
        
        .message-text {
            font-size: 20px;
            color: #e83e8c;
            margin-bottom: 15px;
        }
        
        .floating-text {
            position: absolute;
            color: #e83e8c;
            font-weight: bold;
            animation: float-up 1.5s forwards;
            z-index: 15;
            pointer-events: none;
            white-space: nowrap;
        }
        
        .unlocked-message {
            background-color: #fff0f5;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            text-align: left;
            position: relative;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        
        .unlocked-message:before {
            content: "‚ù§Ô∏è";
            margin-right: 10px;
        }
        
        .health-bar {
            position: absolute;
            top: 50px;
            left: 20px;
            width: 100px;
            height: 15px;
            background-color: rgba(255, 255, 255, 0.5);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .health-fill {
            height: 100%;
            width: 100%;
            background: linear-gradient(to right, #ff6b6b, #e83e8c);
            border-radius: 10px;
            transition: width 0.3s;
        }
        
        @keyframes fall {
            from { top: -50px; }
            to { top: 110%; }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        @keyframes float-up {
            0% {
                opacity: 1;
                transform: translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateY(-50px);
            }
        }
        
        @media (max-width: 600px) {
            #game-screen {
                height: 400px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Start Screen -->
        <div id="start-screen">
            <h1>Kalpleri Yakala</h1>
            <p>Bu sevgi dolu oyunda, g√∂kten d√º≈üen kalpleri yakalamaya √ßalƒ±≈ü! Her kalp sana puan kazandƒ±rƒ±r ve √∂zel kalpler gizli a≈ük mesajlarƒ± a√ßƒ±ƒüa √ßƒ±karƒ±r.</p>
            <p>D√º≈üen nesnelerden ka√ßƒ±n, yoksa canƒ±n azalƒ±r. Fare veya dokunmatik ekranla karakterini hareket ettir.</p>
            <button id="start-button">Oynamaya Ba≈üla ‚ù§Ô∏è</button>
        </div>
        
        <!-- Game Screen -->
        <div id="game-screen">
            <div class="score-display">Puan: <span id="score">0</span></div>
            <div class="message-count">Mesajlar: <span id="messages-found">0</span>/<span id="total-messages">10</span></div>
            <div class="health-bar">
                <div class="health-fill" id="health-fill"></div>
            </div>
            <div class="player" id="player">‚ù§Ô∏è</div>
            <div class="message-popup" id="message-popup">
                <div class="message-text" id="message-text"></div>
                <button id="continue-button">Devam Et</button>
            </div>
        </div>
        
        <!-- End Screen -->
        <div id="end-screen">
            <h1>Oyun Bitti</h1>
            <p>Toplam puan: <span id="final-score">0</span></p>
            <p>Bulunan mesajlar: <span id="final-messages">0</span>/10</p>
            <h2>A√ßƒ±lan A≈ük Mesajlarƒ±:</h2>
            <div id="messages-container"></div>
            <button id="restart-button">Tekrar Oyna</button>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Elements
            const startScreen = document.getElementById('start-screen');
            const gameScreen = document.getElementById('game-screen');
            const endScreen = document.getElementById('end-screen');
            const startButton = document.getElementById('start-button');
            const restartButton = document.getElementById('restart-button');
            const player = document.getElementById('player');
            const scoreElement = document.getElementById('score');
            const messagesFoundElement = document.getElementById('messages-found');
            const totalMessagesElement = document.getElementById('total-messages');
            const messagePopup = document.getElementById('message-popup');
            const messageText = document.getElementById('message-text');
            const continueButton = document.getElementById('continue-button');
            const finalScoreElement = document.getElementById('final-score');
            const finalMessagesElement = document.getElementById('final-messages');
            const messagesContainer = document.getElementById('messages-container');
            const healthFill = document.getElementById('health-fill');
            
            // Game variables
            let score = 0;
            let health = 100;
            let isGameActive = false;
            let playerPosition = 0;
            let gameWidth = 0;
            let messagesFound = 0;
            let gameIntervals = [];
            let unlockedMessages = [];
            
            // Love messages in Turkish
            const loveMessages = [
                "Uzakta olsan da her zaman kalbimdesin! ‚ù§Ô∏è",
                "Mesafeler sevgimizi daha da g√º√ßlendiriyor. üíï",
                "Her ge√ßen g√ºn seni daha √ßok seviyorum. üíñ",
                "D√º≈ü√ºncelerimde ve kalbimde her zaman √∂zel bir yerin var. üíì",
                "Bizi ayƒ±ran kilometreler, bir g√ºn bizi birle≈ütiren adƒ±mlar olacak. ü•∞",
                "Sesini √∂zl√ºyorum, g√ºl√º≈ü√ºn√º √∂zl√ºyorum, seni √∂zl√ºyorum. üíó",
                "Seninle ge√ßirdiƒüim anƒ±lar, en deƒüerli hazinem. ‚ú®",
                "A≈ükƒ±mƒ±z mesafelere meydan okuyor. üí™",
                "Seni g√∂rene kadar sayƒ±yorum g√ºnleri... ‚è≥",
                "Bir kalp atƒ±≈üƒ± kadar yakƒ±nsƒ±n bana. üíò"
            ];
            
            // Initialize game
            function initGame() {
                gameWidth = gameScreen.clientWidth - player.clientWidth;
                player.style.left = gameWidth / 2 + 'px';
                
                // Update total messages display
                totalMessagesElement.textContent = loveMessages.length;
                
                // Set player controls
                setupPlayerControls();
            }
            
            // Setup player controls
            function setupPlayerControls() {
                // Mouse movement
                gameScreen.addEventListener('mousemove', function(e) {
                    if (!isGameActive) return;
                    
                    const rect = gameScreen.getBoundingClientRect();
                    let newPosition = e.clientX - rect.left - (player.clientWidth / 2);
                    
                    // Constrain to game area
                    newPosition = Math.max(0, Math.min(gameWidth, newPosition));
                    player.style.left = newPosition + 'px';
                    playerPosition = newPosition;
                });
                
                // Touch movement for mobile
                gameScreen.addEventListener('touchmove', function(e) {
                    if (!isGameActive) return;
                    e.preventDefault();
                    
                    const rect = gameScreen.getBoundingClientRect();
                    const touch = e.touches[0];
                    let newPosition = touch.clientX - rect.left - (player.clientWidth / 2);
                    
                    // Constrain to game area
                    newPosition = Math.max(0, Math.min(gameWidth, newPosition));
                    player.style.left = newPosition + 'px';
                    playerPosition = newPosition;
                }, { passive: false });
            }
            
            // Start game
            function startGame() {
                // Reset game variables
                score = 0;
                health = 100;
                isGameActive = true;
                messagesFound = 0;
                unlockedMessages = [];
                
                // Clear any existing game elements
                clearGameIntervals();
                clearGameElements();
                
                // Update UI
                scoreElement.textContent = score;
                messagesFoundElement.textContent = messagesFound;
                healthFill.style.width = '100%';
                
                // Show game screen
                startScreen.style.display = 'none';
                gameScreen.style.display = 'block';
                endScreen.style.display = 'none';
                
                // Initialize game
                initGame();
                
                // Start spawning hearts and obstacles
                gameIntervals.push(setInterval(spawnHeart, 800));
                gameIntervals.push(setInterval(spawnSpecialHeart, 8000));
                gameIntervals.push(setInterval(spawnObstacle, 1500));
            }
            
            // Spawn a regular heart
            function spawnHeart() {
                if (!isGameActive) return;
                
                const heart = document.createElement('div');
                heart.className = 'falling-heart';
                heart.innerHTML = getRandomHeartEmoji();
                
                // Random horizontal position
                const heartWidth = 30;
                const maxX = gameScreen.clientWidth - heartWidth;
                const randomX = Math.random() * maxX;
                
                heart.style.left = randomX + 'px';
                heart.style.top = '-30px';
                
                // Random fall speed
                const fallDuration = 3 + Math.random() * 2;
                heart.style.animationDuration = fallDuration + 's';
                
                gameScreen.appendChild(heart);
                
                // Check collision and remove when animation ends
                const checkCollision = setInterval(() => {
                    if (!isGameActive || !heart.parentNode) {
                        clearInterval(checkCollision);
                        return;
                    }
                    
                    const heartRect = heart.getBoundingClientRect();
                    const playerRect = player.getBoundingClientRect();
                    
                    // Check if the heart is caught
                    if (isColliding(heartRect, playerRect)) {
                        clearInterval(checkCollision);
                        
                        // Award points
                        score += 10;
                        scoreElement.textContent = score;
                        
                        // Show floating text
                        createFloatingText(heartRect.left, heartRect.top, '+10');
                        
                        // Remove heart
                        if (heart.parentNode) {
                            heart.parentNode.removeChild(heart);
                        }
                    }
                    
                    // Remove heart if it's off-screen
                    if (heart.getBoundingClientRect().top > gameScreen.clientHeight + 50) {
                        clearInterval(checkCollision);
                        if (heart.parentNode) {
                            heart.parentNode.removeChild(heart);
                        }
                    }
                }, 100);
                
                // Remove heart after animation is complete (as a fallback)
                setTimeout(() => {
                    if (heart.parentNode) {
                        heart.parentNode.removeChild(heart);
                        clearInterval(checkCollision);
                    }
                }, fallDuration * 1000 + 1000);
            }
            
            // Spawn a special heart with message
            function spawnSpecialHeart() {
                if (!isGameActive) return;
                if (messagesFound >= loveMessages.length) return;
                
                const specialHeart = document.createElement('div');
                specialHeart.className = 'special-heart';
                specialHeart.innerHTML = 'üíñ';
                
                // Random horizontal position
                const heartWidth = 40;
                const maxX = gameScreen.clientWidth - heartWidth;
                const randomX = Math.random() * maxX;
                
                specialHeart.style.left = randomX + 'px';
                specialHeart.style.top = '-40px';
                
                // Slower fall speed for special hearts
                const fallDuration = 5 + Math.random() * 2;
                specialHeart.style.animationDuration = fallDuration + 's';
                
                gameScreen.appendChild(specialHeart);
                
                // Check collision and remove when animation ends
                const checkCollision = setInterval(() => {
                    if (!isGameActive || !specialHeart.parentNode) {
                        clearInterval(checkCollision);
                        return;
                    }
                    
                    const heartRect = specialHeart.getBoundingClientRect();
                    const playerRect = player.getBoundingClientRect();
                    
                    // Check if the special heart is caught
                    if (isColliding(heartRect, playerRect)) {
                        clearInterval(checkCollision);
                        
                        // Award points
                        score += 30;
                        scoreElement.textContent = score;
                        
                        // Show floating text
                        createFloatingText(heartRect.left, heartRect.top, '+30 A≈ük Mesajƒ± A√ßƒ±ldƒ±!');
                        
                        // Remove special heart
                        if (specialHeart.parentNode) {
                            specialHeart.parentNode.removeChild(specialHeart);
                        }
                        
                        // Reveal a message
                        revealMessage();
                    }
                    
                    // Remove special heart if it's off-screen
                    if (specialHeart.getBoundingClientRect().top > gameScreen.clientHeight + 50) {
                        clearInterval(checkCollision);
                        if (specialHeart.parentNode) {
                            specialHeart.parentNode.removeChild(specialHeart);
                        }
                    }
                }, 100);
                
                // Remove special heart after animation is complete (as a fallback)
                setTimeout(() => {
                    if (specialHeart.parentNode) {
                        specialHeart.parentNode.removeChild(specialHeart);
                        clearInterval(checkCollision);
                    }
                }, fallDuration * 1000 + 1000);
            }
            
            // Spawn an obstacle
            function spawnObstacle() {
                if (!isGameActive) return;
                
                const obstacle = document.createElement('div');
                obstacle.className = 'obstacle';
                
                // Random size
                const width = 30 + Math.random() * 40;
                const height = 20 + Math.random() * 20;
                
                obstacle.style.width = width + 'px';
                obstacle.style.height = height + 'px';
                
                // Random horizontal position
                const maxX = gameScreen.clientWidth - width;
                const randomX = Math.random() * maxX;
                
                obstacle.style.left = randomX + 'px';
                obstacle.style.top = '-30px';
                
                // Random fall speed
                const fallDuration = 2 + Math.random() * 2;
                obstacle.style.animationDuration = fallDuration + 's';
                
                gameScreen.appendChild(obstacle);
                
                // Check collision and remove when animation ends
                const checkCollision = setInterval(() => {
                    if (!isGameActive || !obstacle.parentNode) {
                        clearInterval(checkCollision);
                        return;
                    }
                    
                    const obstacleRect = obstacle.getBoundingClientRect();
                    const playerRect = player.getBoundingClientRect();
                    
                    // Check if the obstacle hits the player
                    if (isColliding(obstacleRect, playerRect)) {
                        clearInterval(checkCollision);
                        
                        // Reduce health
                        health = Math.max(0, health - 20);
                        healthFill.style.width = health + '%';
                        
                        // Visual feedback
                        obstacle.style.backgroundColor = 'rgba(255, 0, 0, 0.3)';
                        
                        // Show floating text
                        createFloatingText(obstacleRect.left, obstacleRect.top, '-20 Can');
                        
                        // Remove obstacle
                        setTimeout(() => {
                            if (obstacle.parentNode) {
                                obstacle.parentNode.removeChild(obstacle);
                            }
                        }, 200);
                        
                        // Check if game over
                        if (health <= 0) {
                            endGame();
                        }
                    }
                    
                    // Remove obstacle if it's off-screen
                    if (obstacle.getBoundingClientRect().top > gameScreen.clientHeight + 50) {
                        clearInterval(checkCollision);
                        if (obstacle.parentNode) {
                            obstacle.parentNode.removeChild(obstacle);
                        }
                    }
                }, 100);
                
                // Remove obstacle after animation is complete (as a fallback)
                setTimeout(() => {
                    if (obstacle.parentNode) {
                        obstacle.parentNode.removeChild(obstacle);
                        clearInterval(checkCollision);
                    }
                }, fallDuration * 1000 + 1000);
            }
            
            // Reveal a love message
            function revealMessage() {
                if (messagesFound >= loveMessages.length) return;
                
                // Find an unrevealed message
                let availableMessages = loveMessages.filter(msg => !unlockedMessages.includes(msg));
                if (availableMessages.length === 0) return;
                
                const message = availableMessages[Math.floor(Math.random() * availableMessages.length)];
                unlockedMessages.push(message);
                
                // Update messages count
                messagesFound++;
                messagesFoundElement.textContent = messagesFound;
                
                // Pause the game
                pauseGame();
                
                // Show message popup
                messageText.textContent = message;
                messagePopup.style.display = 'block';
            }
            
            // Create floating text effect
            function createFloatingText(x, y, text) {
                const floatingText = document.createElement('div');
                floatingText.className = 'floating-text';
                floatingText.textContent = text;
                floatingText.style.left = x + 'px';
                floatingText.style.top = y + 'px';
                
                gameScreen.appendChild(floatingText);
                
                // Remove after animation completes
                setTimeout(() => {
                    if (floatingText.parentNode) {
                        floatingText.parentNode.removeChild(floatingText);
                    }
                }, 1500);
            }
            
            // Pause the game
            function pauseGame() {
                // Pause all animations
                const elements = gameScreen.querySelectorAll('.falling-heart, .special-heart, .obstacle');
                elements.forEach(element => {
                    element.style.animationPlayState = 'paused';
                });
                
                isGameActive = false;
            }
            
            // Resume the game
            function resumeGame() {
                // Resume all animations
                const elements = gameScreen.querySelectorAll('.falling-heart, .special-heart, .obstacle');
                elements.forEach(element => {
                    element.style.animationPlayState = 'running';
                });
                
                isGameActive = true;
            }
            
            // End the game
            function endGame() {
                isGameActive = false;
                
                // Stop all game intervals
                clearGameIntervals();
                
                // Update end screen
                finalScoreElement.textContent = score;
                finalMessagesElement.textContent = messagesFound;
                
                // Populate messages container
                messagesContainer.innerHTML = '';
                if (unlockedMessages.length > 0) {
                    unlockedMessages.forEach(message => {
                        const messageElement = document.createElement('div');
                        messageElement.className = 'unlocked-message';
                        messageElement.textContent = message;
                        messagesContainer.appendChild(messageElement);
                    });
                } else {
                    messagesContainer.innerHTML = '<p>Hi√ß mesaj bulamadƒ±n. Tekrar dene!</p>';
                }
                
                // Show end screen
                gameScreen.style.display = 'none';
                endScreen.style.display = 'block';
            }
            
            // Clear all game intervals
            function clearGameIntervals() {
                gameIntervals.forEach(interval => clearInterval(interval));
                gameIntervals = [];
            }
            
            // Clear game elements
            function clearGameElements() {
                const elements = gameScreen.querySelectorAll('.falling-heart, .special-heart, .obstacle, .floating-text');
                elements.forEach(element => {
                    if (element.parentNode) {
                        element.parentNode.removeChild(element);
                    }
                });
            }
            
            // Collision detection
            function isColliding(rect1, rect2) {
                return !(
                    rect1.right < rect2.left || 
                    rect1.left > rect2.right || 
                    rect1.bottom < rect2.top || 
                    rect1.top > rect2.bottom
                );
            }
            
            // Random heart emoji
            function getRandomHeartEmoji() {
                const hearts = ['‚ù§Ô∏è', 'üíï', 'üíì', 'üíó', 'üíò', 'üíù', 'üíû', 'üíñ'];
                return hearts[Math.floor(Math.random() * hearts.length)];
            }
            
            // Button event listeners
            startButton.addEventListener('click', startGame);
            restartButton.addEventListener('click', startGame);
            continueButton.addEventListener('click', function() {
                messagePopup.style.display = 'none';
                resumeGame();
            });
            
            // Window resize event
            window.addEventListener('resize', function() {
                if (isGameActive) {
                    gameWidth = gameScreen.clientWidth - player.clientWidth;
                    const currentLeft = parseInt(player.style.left);
                    player.style.left = Math.min(currentLeft, gameWidth) + 'px';
                }
            });
            
            // Initialize on load
            window.addEventListener('load', function() {
                initGame();
            });
        });
    </script>
</body>
</html>